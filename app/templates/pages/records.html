{% extends "base.html" %}

{% block title %}{{ _("Ð ÐµÐºÐ¾Ñ€Ð´Ñ‹ 2048") }}{% endblock %}
{% block extra_styles %}
<style>
    /* General page layout */
    .heading {
        text-align: center;
        margin: 20px 0;
    }

    .title {
        font-size: 28px;
        font-weight: bold;
        color: #333;
        font-family: "Inter", sans-serif;
    }

    /* Force-fit table into container */
    .score-table {
        margin: 15px auto;
        max-width: 100%;
    }

    .score-table table {
        border-collapse: collapse;
        width: 100%;
        background: #faf8ef;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
        font-size: 12px; /* smaller font */
        table-layout: fixed; /* force columns to shrink */
    }

    /* Table cells */
    .score-table th,
    .score-table td {
        padding: 6px 8px; /* smaller padding */
        text-align: center;
        word-wrap: break-word; /* allow wrapping */
        overflow: hidden;
        text-overflow: ellipsis;
    }

    /* Column widths (auto shrink to fit) */
    .score-table th:nth-child(1),
    .score-table td:nth-child(1) {
        width: 15%; /* Rank */
    }

    .score-table th:nth-child(2),
    .score-table td:nth-child(2) {
        width: 30%; /* Telegram ID */
    }

    .score-table th:nth-child(3),
    .score-table td:nth-child(3) {
        width: 25%; /* Name */
    }

    .score-table th:nth-child(4),
    .score-table td:nth-child(4) {
        width: 20%; /* Score */
    }

    /* Rank icons */
    .rank-icon {
        font-size: 16px;
    }


    .rank-icon {
        font-size: 20px;
    }

    /* Button group styling (same as game controls for consistency) */
    .button-group {
        display: flex;
        justify-content: center;
        gap: 14px;
        background: #faf8ef;
        padding: 12px 20px;
        border-radius: 16px;
        margin: 20px auto;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        width: fit-content;
    }

    .icon-btn {
        background: #f5f5f5;
        border: none;
        outline: none;
        cursor: pointer;
        border-radius: 12px;
        padding: 12px;
        transition: all 0.25s ease;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .icon-btn svg {
        width: 28px;
        height: 28px;
        color: #444;
        transition: color 0.25s ease;
    }

    /* Hover effects */
    .icon-btn:hover {
        background: #e0dfd5;
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .icon-btn:active {
        transform: scale(0.95);
    }

    /* Button color highlights */
    .play-btn:hover svg {
        color: #4caf50; /* Green for play */
    }

    .reset-btn:hover svg {
        color: #2196f3; /* Blue for refresh */
    }

    .exit-btn:hover svg {
        color: #f44336; /* Red for exit */
    }

</style>
{% endblock %}
{% block content %}
{% if records %}
<div class="heading">
    <h1 class="title">{{ _("Top") }} {{ records|length }} {{ _("ta o'yinchilar") }}</h1>
</div>
<div class="score-table">
    <table>
        <thead>
        <tr>
            <th>{{ _("O'rin") }}</th>
            <th>{{ _("Telegram ID") }}</th>
            <th>{{ _("Ismi") }}</th>
            <th>{{ _("Ochko") }}</th>
        </tr>
        </thead>
        <tbody>
        {% for record in records %}
        <tr>
            <td class="{% if record.rank == 1 %}first-place{% elif record.rank == 2 %}second-place{% elif record.rank == 3 %}third-place{% endif %}">
                    <span class="rank-icon">
                        {% if record.rank == 1 %}ðŸ¥‡
                        {% elif record.rank == 2 %}ðŸ¥ˆ
                        {% elif record.rank == 3 %}ðŸ¥‰
                        {% else %}{{ record.rank }}
                        {% endif %}
                    </span>
            </td>
            <td>{{ record.telegram_id }}</td>
            <td>{{ record.first_name }}</td>
            <td>{{ record.best_score }}</td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
</div>
<div class="button-group">
    <button class="icon-btn play-btn" onclick="window.location.href='/'">
        <!-- Play Icon -->
        <svg width="24" height="24" viewBox="0 0 24 24">
            <path d="M8 5v14l11-7z" fill="currentColor"></path>
        </svg>
    </button>
    <button class="icon-btn reset-btn" id="clearStorageButton">
        <!-- Reset Icon -->
        <svg width="24" height="24" viewBox="0 0 24 24">
            <path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 .34-.03.67-.08 1H18c0-3.31-2.69-6-6-6zM6 13c0 3.31 2.69 6 6 6v3l4-4-4-4v3c-2.76 0-5-2.24-5-5H6c0 .34.03.67.08 1H6c-.05-.33-.08-.66-.08-1z"
                  fill="currentColor"></path>
        </svg>
    </button>
    <button class="icon-btn exit-btn" onclick="window.Telegram.WebApp.close()">
        <!-- Exit Icon -->
        <svg width="24" height="24" viewBox="0 0 24 24">
            <path d="M16 13v-2H7V9l-5 4 5 4v-3h9zM19 3H5c-1.1 0-2 .9-2 2v4h2V5h14v14H5v-4H3v4c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"
                  fill="currentColor"></path>
        </svg>
    </button>
</div>
{% else %}
<div class="heading">
    <h1 class="title">{{ _("Hali ishtirokchilar mavjud emas!") }}</h1>
</div>
<div class="button-group">
    <button class="icon-btn play-btn" onclick="window.location.href='/'">
        <!-- Play Icon -->
        <svg width="24" height="24" viewBox="0 0 24 24">
            <path d="M8 5v14l11-7z" fill="currentColor"></path>
        </svg>
    </button>
    <button class="icon-btn exit-btn" onclick="window.Telegram.WebApp.close()">
        <!-- Exit Icon -->
        <svg width="24" height="24" viewBox="0 0 24 24">
            <path d="M16 13v-2H7V9l-5 4 5 4v-3h9zM19 3H5c-1.1 0-2 .9-2 2v4h2V5h14v14H5v-4H3v4c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"
                  fill="currentColor"></path>
        </svg>
    </button>
</div>
{% endif %}

{% endblock %}

{% block extra_scripts %}
<script src="/static/js/local_storage_manager.js?v=1.1.4"></script>
{% endblock %}
